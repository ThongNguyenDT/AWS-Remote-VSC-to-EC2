<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.132.0"><meta name=description content><meta name=author content="journeyoftheaverageguy@gmail.com"><link rel=icon href=/AWS-Remote-VSC-to-EC2/images/favicon.png type=image/png><title>6-Generate VSCode from AMI build from EC2 Image Builder :: AWS System Manager</title>
<link href=/AWS-Remote-VSC-to-EC2/css/nucleus.css?1724927887 rel=stylesheet><link href=/AWS-Remote-VSC-to-EC2/css/fontawesome-all.min.css?1724927887 rel=stylesheet><link href=/AWS-Remote-VSC-to-EC2/css/hybrid.css?1724927887 rel=stylesheet><link href=/AWS-Remote-VSC-to-EC2/css/featherlight.min.css?1724927887 rel=stylesheet><link href=/AWS-Remote-VSC-to-EC2/css/perfect-scrollbar.min.css?1724927887 rel=stylesheet><link href=/AWS-Remote-VSC-to-EC2/css/auto-complete.css?1724927887 rel=stylesheet><link href=/AWS-Remote-VSC-to-EC2/css/atom-one-dark-reasonable.css?1724927887 rel=stylesheet><link href=/AWS-Remote-VSC-to-EC2/css/theme.css?1724927887 rel=stylesheet><link href=/AWS-Remote-VSC-to-EC2/css/hugo-theme.css?1724927887 rel=stylesheet><link href=/AWS-Remote-VSC-to-EC2/css/theme-workshop.css?1724927887 rel=stylesheet><script src=/AWS-Remote-VSC-to-EC2/js/jquery-3.3.1.min.js?1724927887></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/AWS-Remote-VSC-to-EC2/6-generate-vscode-from-ami-build-from-ec2-image-builder/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=/><svg id="Layer_1" data-name="Layer 1" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff}.cls-2{fill:#f90;fill-rule:evenodd}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09 10.85a4.7 4.7.0 00.19 1.48 7.73 7.73.0 00.54 1.19.77.77.0 01.12.38.64.64.0 01-.32.49l-1 .7a.83.83.0 01-.44.15.69.69.0 01-.49-.23 3.8 3.8.0 01-.6-.77q-.25-.42-.51-1a6.14 6.14.0 01-4.89 2.3 4.54 4.54.0 01-3.32-1.19 4.27 4.27.0 01-1.22-3.2 4.28 4.28.0 011.46-3.4A6.06 6.06.0 017.69 6.46a12.47 12.47.0 011.76.13q.92.13 1.91.36V5.73a3.65 3.65.0 00-.79-2.66A3.81 3.81.0 007.86 2.3a7.71 7.71.0 00-1.79.22 12.78 12.78.0 00-1.79.57 4.55 4.55.0 01-.58.22h-.26q-.35.0-.35-.52V2a1.09 1.09.0 01.12-.58 1.2 1.2.0 01.47-.35A10.88 10.88.0 015.77.32 10.19 10.19.0 018.36.0a6 6 0 014.35 1.35 5.49 5.49.0 011.38 4.09zM7.34 13.38a5.36 5.36.0 001.72-.31A3.63 3.63.0 0010.63 12 2.62 2.62.0 0011.19 11a5.63 5.63.0 00.16-1.44v-.7a14.35 14.35.0 00-1.53-.28 12.37 12.37.0 00-1.56-.1 3.84 3.84.0 00-2.47.67A2.34 2.34.0 005 11a2.35 2.35.0 00.61 1.76A2.4 2.4.0 007.34 13.38zm13.35 1.8a1 1 0 01-.64-.16 1.3 1.3.0 01-.35-.65L15.81 1.51a3 3 0 01-.15-.67.36.36.0 01.41-.41H17.7a1 1 0 01.65.16 1.4 1.4.0 01.33.65l2.79 11 2.59-11A1.17 1.17.0 0124.39.6a1.1 1.1.0 01.67-.16H26.4a1.1 1.1.0 01.67.16 1.17 1.17.0 01.32.65L30 12.39 32.88 1.25A1.39 1.39.0 0133.22.6a1 1 0 01.65-.16h1.54a.36.36.0 01.41.41 1.36 1.36.0 010 .26 3.64 3.64.0 01-.12.41l-4 12.86a1.3 1.3.0 01-.35.65 1 1 0 01-.64.16H29.25a1 1 0 01-.67-.17 1.26 1.26.0 01-.32-.67L25.67 3.64l-2.56 10.7a1.26 1.26.0 01-.32.67 1 1 0 01-.67.17zm21.36.44a11.28 11.28.0 01-2.56-.29 7.44 7.44.0 01-1.92-.67 1 1 0 01-.61-.93v-.84q0-.52.38-.52a.9.9.0 01.31.06l.42.17a8.77 8.77.0 001.83.58 9.78 9.78.0 002 .2 4.48 4.48.0 002.43-.55 1.76 1.76.0 00.86-1.57 1.61 1.61.0 00-.45-1.16A4.29 4.29.0 0043 9.22l-2.41-.76A5.15 5.15.0 0138 6.78a3.94 3.94.0 01-.83-2.41 3.7 3.7.0 01.45-1.85 4.47 4.47.0 011.19-1.37 5.27 5.27.0 011.7-.86A7.4 7.4.0 0142.6.0a8.87 8.87.0 011.12.07q.57.07 1.08.19t.95.26a4.27 4.27.0 01.7.29 1.59 1.59.0 01.49.41.94.94.0 01.15.55v.79q0 .52-.38.52a1.76 1.76.0 01-.64-.2 7.74 7.74.0 00-3.2-.64 4.37 4.37.0 00-2.21.47 1.6 1.6.0 00-.79 1.48 1.58 1.58.0 00.49 1.18 4.94 4.94.0 001.83.92L44.55 7a5.08 5.08.0 012.57 1.6A3.76 3.76.0 0147.9 11a4.21 4.21.0 01-.44 1.93 4.4 4.4.0 01-1.21 1.47 5.43 5.43.0 01-1.85.93A8.25 8.25.0 0142.05 15.62z"/><path class="cls-2" d="M45.19 23.81C39.72 27.85 31.78 30 25 30A36.64 36.64.0 01.22 20.57c-.51-.46-.06-1.09.56-.74A49.78 49.78.0 0025.53 26.4 49.23 49.23.0 0044.4 22.53C45.32 22.14 46.1 23.14 45.19 23.81z"/><path class="cls-2" d="M47.47 21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74 3.13-2.2 8.27-1.57 8.86-.83s-.16 5.89-3.09 8.35c-.45.38-.88.18-.68-.32C46.69 25.8 48.17 22.11 47.47 21.21z"/></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/AWS-Remote-VSC-to-EC2/js/lunr.min.js?1724927887></script><script type=text/javascript src=/AWS-Remote-VSC-to-EC2/js/auto-complete.js?1724927887></script><script type=text/javascript>var baseurl="https://thongnguyendt.github.io/AWS-Remote-VSC-to-EC2/"</script><script type=text/javascript src=/AWS-Remote-VSC-to-EC2/js/search.js?1724927887></script></div><div class=highlightable><ul class=topics><li data-nav-id=/AWS-Remote-VSC-to-EC2/1-connect-vscode-to-aws-ec2-using-ssh/ title="Connect VSCode to AWS EC2 using SSH" class=dd-item><a href=/AWS-Remote-VSC-to-EC2/1-connect-vscode-to-aws-ec2-using-ssh/><b>1. </b>Connect VSCode to AWS EC2 using SSH
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/AWS-Remote-VSC-to-EC2/2-connect-vscode-to-aws-ec2-using-zerotier/ title="Connect VSCode to AWS EC2 using Zerotier" class=dd-item><a href=/AWS-Remote-VSC-to-EC2/2-connect-vscode-to-aws-ec2-using-zerotier/><b>2. </b>Connect VSCode to AWS EC2 using Zerotier
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/AWS-Remote-VSC-to-EC2/3-hosting-vs-code-on-ec2-from-amazon-linux-2/ title="Hosting VS Code on EC2 from Amazon Linux 2" class=dd-item><a href=/AWS-Remote-VSC-to-EC2/3-hosting-vs-code-on-ec2-from-amazon-linux-2/><b>3. </b>Hosting VS Code on EC2 from Amazon Linux 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/AWS-Remote-VSC-to-EC2/4-manually-deploy-vs-code-on-ec2/ title="Manually deploy VS Code on EC2" class=dd-item><a href=/AWS-Remote-VSC-to-EC2/4-manually-deploy-vs-code-on-ec2/><b>4. </b>Manually deploy VS Code on EC2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/AWS-Remote-VSC-to-EC2/5-extended-create-an-ami-from-an-instance-and-run-an-instance-from-that-ami/ title=Appendix class=dd-item><a href=/AWS-Remote-VSC-to-EC2/5-extended-create-an-ami-from-an-instance-and-run-an-instance-from-that-ami/><b>5. </b>Appendix
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/AWS-Remote-VSC-to-EC2/6-generate-vscode-from-ami-build-from-ec2-image-builder/ title="6-Generate VSCode from AMI build from EC2 Image Builder" class="dd-item
active"><a href=/AWS-Remote-VSC-to-EC2/6-generate-vscode-from-ami-build-from-ec2-image-builder/><b>6. </b>6-Generate VSCode from AMI build from EC2 Image Builder
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/AWS-Remote-VSC-to-EC2/7-connect-vscode-using-ec2_instances_connect-and-aws-systems-manager/ title="Connect VScode using EC2_Instances_Connect and AWS Systems Manager" class=dd-item><a href=/AWS-Remote-VSC-to-EC2/7-connect-vscode-using-ec2_instances_connect-and-aws-systems-manager/><b>7. </b>Connect VScode using EC2_Instances_Connect and AWS Systems Manager
<i class="fas fa-check read-icon"></i></a></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://www.facebook.com/groups/awsstudygroupfcj/><i class='fab fa-facebook'></i> AWS Study Group</a></li></ul></section><section id=prefooter><hr><ul><li><a class=padding><i class="fas fa-language fa-fw"></i><div class=select-style><select id=select-language onchange="location=this.value"><option id=en value=https://thongnguyendt.github.io/AWS-Remote-VSC-to-EC2/6-generate-vscode-from-ami-build-from-ec2-image-builder/ selected>English</option><option id=vi value=https://thongnguyendt.github.io/AWS-Remote-VSC-to-EC2/vi/6-generate-vscode-from-ami-build-from-ec2-image-builder/>Tiếng Việt</option></select><svg id="Capa_1" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><polygon points="0,63.75 127.5,191.25 255,63.75"/></g></g></svg></div></a></li><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></section><section id=footer><left><b>Workshop</b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title=Migrate alt="web counter" border=0></a><br><b><a href=https://cloudjourney.awsstudygroup.com/>Cloud Journey</a></b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total Cloud Journey" alt="web counter" border=0>
</left><left><br><br><b>Last Updated</b><br><i><font color=orange>11-08-2024</font>
</i></left><left><br><br><b>Author</b><br><i><a href=# style=color:orange>Tien Thong</a><br><a href=https://www.linkedin.com/in/levuxuanan/ style=color:orange>Xuan An</a><br><a href=https://www.linkedin.com/in/anh-p-47063a13a/ style=color:orange>Hai An</a><br></i></left><script async defer src=https://buttons.github.io/buttons.js></script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=/AWS-Remote-VSC-to-EC2/>REMOTE DEVELOPMENT WITH VS VSCODE AND EC2</a> > 6-Generate VSCode from AMI build from EC2 Image Builder</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#61-terminology>6.1. Terminology</a><ul><li><a href=#621-ami>6.2.1. AMI</a></li><li><a href=#622-image-pipeline>6.2.2. Image Pipeline</a></li><li><a href=#623-image-recipe>6.2.3. Image Recipe</a></li><li><a href=#624-source-image>6.2.4. Source Image</a></li><li><a href=#625-build-components>6.2.5. Build Components</a></li></ul></li><li><a href=#62-deployment--621-create-component--step-1-access-components-consolehttpsus-east-1consoleawsamazoncomimagebuilderhomeregionus-east-1components-click-create-component>6.2. Deployment ### 6.2.1. Create Component ### Step 1: Access <a href="https://us-east-1.console.aws.amazon.com/imagebuilder/home?region=us-east-1#/components">Components console</a>. Click Create component.</a><ul><li><a href=#step-3-select-values-from-the-following-list>Step 3: Select values ​​from the following list</a></li><li><a href=#step-4-in-the-definition-document-section-content-section-copy-the-following-content>Step 4: In the Definition document section, Content section, copy the following content:</a></li><li><a href=#step-5-select-create-component>Step 5: Select “Create Component”.</a></li><li><a href=#step-6-sub-create-a-new-version-by-selecting-action--create-new-version>Step 6 (Sub): Create a new version by selecting Action → Create new version.</a></li><li><a href=#622-create-a-role-for-ec2-image-builder>6.2.2. Create a role for EC2 Image Builder</a></li><li><a href=#step-1-select-aws-service-use-case-ec2>Step 1: Select <code>AWS service</code>, use case <code>EC2</code></a></li><li><a href=#step-2-add-policies-as-shown-below>Step 2: Add policies as shown below</a></li><li><a href=#step-3-name-the-role-ec2imagebuilderinfraconfigrole-and-describe>Step 3: Name the Role <code>EC2ImageBuilderInfraConfigRole</code> and describe</a></li><li><a href=#623-create-pipeline>6.2.3. Create pipeline</a></li><li><a href=#step-1-go-to-pipeline-consolehttpsus-east-1consoleawsamazoncomimagebuilderhomeregionus-east-1createpipeline>Step 1: Go to <a href="https://us-east-1.console.aws.amazon.com/imagebuilder/home?region=us-east-1#/createPipeline">pipeline console</a>.</a></li><li><a href=#step-2-name-the-pipeline-vsc-pipeline--description-optional>Step 2: Name the pipeline <code>VSC-Pipeline</code> . Description optional.</a></li><li><a href=#step-3-in-the-build-schedule-section-select-manual-and-then-select-next>Step 3: In the Build schedule section, select <code>Manual</code> and then select Next.</a></li><li><a href=#step-4-in-the-recipe-section-select-create-new-recipe--select-ami-in-image-type>Step 4: In the Recipe section, select <code>Create new recipe</code> . Select <code>AMI</code> in Image type</a></li><li><a href=#step-5-general-name-the-ami-and-version>Step 5: General, name the ami and version</a></li><li><a href=#step-6-base-image-select-select-managed-images-and-amazon-linux>Step 6: Base image, select <code>Select managed images</code> and <code>Amazon Linux</code></a></li><li><a href=#step-7-at-image-origin-select-quick-start--at-image-name-select-amazon-linux-2023-x86--select-compatible-version-currently-select-use-latest-available-os-version>Step 7: At Image origin, select <code>Quick start</code> . At Image name, select <code>Amazon Linux 2023 x86</code> . Select compatible version, currently select <code>Use latest available OS version</code></a></li><li><a href=#step-8-in-working-directory-type-homeec2-user-because-it-will-download-nvm-into-the-home-directory-of-the-executing-user-which-is-ec2-user>Step 8: In Working directory, type <code>/home/ec2-user</code> because it will download nvm into the home directory of the executing user, which is ec2-user.</a></li><li><a href=#step-9-in-filter-owner-in-components-section-select-owned-by-me-select-the-created-component>Step 9: In <code>Filter owner</code> in Components section, select <code>Owned by me</code>. Select the created component.</a></li><li><a href=#step-10-leave-the-storage-section-as-default-and-then-next>Step 10: Leave the Storage section as default and then Next.</a></li><li><a href=#step-11-in-the-define-image-creation-process-section-select-next>Step 11: In the Define image creation process section, select Next.</a></li><li><a href=#step-12-in-the-infrastructure-configuration-section-select-create-a-new-infrastructure-configuration-name-it-vsc-infraconfig-select-the-iam-role-you-created>Step 12: In the Infrastructure configuration section, select <code>Create a new infrastructure configuration</code>. Name it <code>VSC-InfraConfig</code>. Select the IAM role you created.</a></li><li><a href=#step-13-expand-the-vpc-subnet-and-security-groups-section-select-instance-type-as-t3medium-vpc-as-vsc-created-in-part-4-select-1-of-2-private-subnets-select-security-group-with-vsc-security-without-inbound-rule-of-previous-part-to-be-able-to-create-and-evaluate-instance-select-next>Step 13: Expand the VPC, subnet and security groups section. Select instance type as <code>t3.medium</code>, VPC as <code>VSC</code> (created in Part 4), select 1 of 2 <code>private subnets</code>, select security group with <code>VSC</code> (security without inbound rule of previous part) to be able to create and evaluate instance. Select Next.</a></li><li><a href=#step-14-leave-distribution-settings-as-default-and-then-next>Step 14: Leave distribution settings as default and then Next.</a></li><li><a href=#step-15-after-reviewing-select-create-pipeline>Step 15: After reviewing, select Create pipeline.</a></li></ul></li><li><a href=#63-create-instance-from-ami-built-from-pipeline>6.3. Create instance from AMI built from pipeline</a><ul><li><a href=#631-create-ami-from-pipeline>6.3.1. Create AMI from pipeline</a></li><li><a href=#step-1-select-the-newly-created-pipeline-in-the-action-box-select-run-pipeline>Step 1: Select the newly created pipeline. In the Action box, select Run pipeline:</a></li><li><a href=#step-2-click-view-details-to-monitor-the-details>Step 2: Click <code>View details</code> to monitor the details:</a></li><li><a href=#step-3-select-the-log-stream-link-to-monitor-the-pipelines-cloudwatch-log-stream>Step 3: Select the log stream link to monitor the pipeline&rsquo;s CloudWatch log stream</a></li><li><a href=#step-4-go-back-to-the-running-pipeline-when-the-ami-build-is-finished-the-image-status-changes-to-available-click-on-the-created-image-version-the-image-below-is-1041>Step 4: Go back to the running pipeline. When the ami build is finished, the image status changes to Available. Click on the created image version (the image below is 1.0.4/1):</a></li><li><a href=#step-5-observe-the-image-created-from-ec2-image-builder-click-on-the-ami-link>Step 5: Observe the image created from EC2 Image Builder. Click on the AMI link:</a></li><li><a href=#step-6-observe-the-ami-from-the-ec2-page>Step 6: Observe the ami from the EC2 page</a></li><li><a href=#632-create-an-instance-from-the-newly-created-ami>6.3.2. Create an instance from the newly created AMI</a></li><li><a href=#step-1-go-to-the-ami-page-of-the-ec2-console-select-the-newly-created-ami-click-launch-instance-from-ami>Step 1: Go to the AMI page of the EC2 console. Select the newly created ami. Click <code>Launch instance from AMI</code></a></li><li><a href=#step-2-select-the-instance-type-to-save-choose-t2micro->Step 2: Select the instance type. To save, choose <code>t2.micro</code> .</a></li><li><a href=#step-3-no-key-pair-required>Step 3: No key pair required.</a></li><li><a href=#step-4-select-vpc-and-security-group-with-vsc--private-subnet-make-sure-there-is-no-public-ip>Step 4: Select VPC and security group with <code>VSC</code> , private subnet, make sure there is no public IP</a></li><li><a href=#step-5-provide-iam-instance-profile-with-vsc-to-install-ssm-agent>Step 5: Provide IAM instance profile with <code>VSC</code> to install SSM agent</a></li><li><a href=#step-6-select-create-instance>Step 6: Select <code>Create instance</code></a></li><li><a href=#step-7-wait-until-instance-status-available>Step 7: Wait until instance status <code>Available</code></a></li><li><a href=#step-8-access-vscode-web-app-using-session-manager-via-port-forwarding-jsx-aws-ssm-start-session----target-i-06ae65824244ff79b----document-name-aws-startportforwardingsessiontoremotehost----parameters-host100132106portnumber8080localportnumber8080--untitledimagespart663-2-step8png-access-successful>Step 8: Access VSCode web app using Session Manager via port forwarding <code>jsx aws ssm start-session ^ --target i-06ae65824244ff79b ^ --document-name AWS-StartPortForwardingSessionToRemoteHost ^ --parameters host="10.0.132.106",portNumber="8080",localPortNumber="8080" </code>![Untitled](/images/part6/6.3 .2.-step8.png) Access successful!</a></li></ul></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>6-Generate VSCode from AMI build from EC2 Image Builder</h1><p>C2 Image Builder automates the creation, management, and deployment of customized, secure, and up-to-date “golden” ami that is pre-installed and pre-configured with software and settings.</p><p>In this section, we will build an AMI similar to part 5, but using EC2 Image Builder to create an image pipeline from infrastructure configuration (OS, VPC, subnet, security group), IAM instance profile, to installing the ami, deploying to an instance and testing the state of that instance, and scanning for security vulnerabilities in the ami.</p><p>Reference: <a href=https://catalog.us-east-1.prod.workshops.aws/workshops/d6c7ecdc-c75f-4ad1-910f-fdd994cc4aed/en-US>AWS for Microsoft Workloads Immersion Day (workshops.aws)</a></p><h2 id=61-terminology>6.1. Terminology</h2><h3 id=621-ami>6.2.1. AMI</h3><p>The basic unit of deployment in Amazon EC2. An AMI is a preconfigured VM image that contains the operating system and pre-installed software for deploying EC2 instances.</p><h3 id=622-image-pipeline>6.2.2. Image Pipeline</h3><p>Automated configuration for building secure operating system images on AWS. The Image Builder pipeline is associated with an <strong>image recipe</strong> that defines the build, validation, and test phases for the image build lifecycle. The image pipeline can be associated with an infrastructure configuration that defines where the image is built. You can define properties such as <em>version</em>*,** subnet, security groups*, <em>logging</em>, and other infrastructure-related configurations.</p><h3 id=623-image-recipe>6.2.3. Image Recipe</h3><p>An image recipe is a document that defines the <em>source image</em> and the components that will be applied to the <em>source image</em> to create the desired configuration for the output image. You can use an image recipe to replicate builds. Image Builder recipes can be shared, forked, and edited using the console, AWS CLI, or API.</p><h3 id=624-source-image>6.2.4. Source Image</h3><p>The selected image and operating system used in your <em>image recipe document</em> along with the components. The source image and component definitions combine to create the desired configuration for the <em>output image.</em></p><h3 id=625-build-components>6.2.5. Build Components</h3><p>Orchestration documents define the sequence of steps to download, install, and configure software packages. They also define authentication and security steps. A component is defined using a YAML document format.</p><h2 id=62-deployment--621-create-component--step-1-access-components-consolehttpsus-east-1consoleawsamazoncomimagebuilderhomeregionus-east-1components-click-create-component>6.2. Deployment ### 6.2.1. Create Component ### Step 1: Access <a href="https://us-east-1.console.aws.amazon.com/imagebuilder/home?region=us-east-1#/components">Components console</a>. Click Create component.</h2><p><img alt=Untitled src=/images/part6/6.2.1-step1.png> ### Step 2: Select Type as <code>Build</code>.</p><p><img alt=Untitled src=/images/part6/6.2.1-step2.png></p><h3 id=step-3-select-values-from-the-following-list>Step 3: Select values ​​from the following list</h3><ul><li>OS: Linux</li><li>Compatible OS Versions: Amazon Linux 2023</li><li>Component name: VSC- Component</li><li>Component version: 1.0.0</li></ul><p><img alt=Untitled src=/images/part6/6.2.1-step3.png></p><h3 id=step-4-in-the-definition-document-section-content-section-copy-the-following-content>Step 4: In the Definition document section, Content section, copy the following content:</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>HelloWorldTestingDocument</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>This</span> <span style=color:#a6e22e>is</span> <span style=color:#a6e22e>hello</span> <span style=color:#a6e22e>world</span> <span style=color:#a6e22e>testing</span> document.
</span></span><span style=display:flex><span><span style=color:#a6e22e>schemaVersion</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1.0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>phases</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>-</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>build</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>steps</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>-</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>HostingVSCode</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>action</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ExecuteBash</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>inputs</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>commands</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>-</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span>              <span style=color:#960050;background-color:#1e0010>#</span><span style=color:#f92672>!</span><span style=color:#960050;background-color:#1e0010>/bin/bash</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>sudo</span> <span style=color:#a6e22e>rpm</span> <span style=color:#f92672>--</span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>https</span><span style=color:#f92672>:</span><span style=color:#75715e>//packages.microsoft.com/keys/microsoft.asc
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>sudo</span> <span style=color:#a6e22e>sh</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>c</span> <span style=color:#e6db74>&#39;echo -e &#34;[code]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              name=Visual Studio Code
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              baseurl=https://packages.microsoft.com/yumrepos/vscode
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              enabled=1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              gpgcheck=1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              gpgkey=https://packages.microsoft.com/keys/microsoft.asc&#34; &gt; /etc/yum.repos.d/vscode.repo&#39;</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>              <span style=color:#960050;background-color:#1e0010>#</span> <span style=color:#a6e22e>https</span><span style=color:#f92672>:</span><span style=color:#75715e>//github.com/amazonlinux/amazon-linux-2023/issues/397
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>sleep</span> <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>              
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>sudo</span> <span style=color:#a6e22e>yum</span> <span style=color:#a6e22e>install</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>y</span> <span style=color:#a6e22e>code</span> <span style=color:#a6e22e>git</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>sudo</span> <span style=color:#a6e22e>tee</span> <span style=color:#f92672>/</span><span style=color:#a6e22e>etc</span><span style=color:#f92672>/</span><span style=color:#a6e22e>systemd</span><span style=color:#f92672>/</span><span style=color:#a6e22e>system</span><span style=color:#f92672>/</span><span style=color:#a6e22e>code</span><span style=color:#f92672>-</span><span style=color:#a6e22e>server</span>.<span style=color:#a6e22e>service</span> <span style=color:#f92672>&lt;&lt;</span><span style=color:#a6e22e>EOF</span>
</span></span><span style=display:flex><span>              [<span style=color:#a6e22e>Unit</span>]
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>Description</span><span style=color:#f92672>=</span><span style=color:#a6e22e>Start</span> <span style=color:#a6e22e>code</span> <span style=color:#a6e22e>server</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>              [<span style=color:#a6e22e>Service</span>]
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>ExecStart</span><span style=color:#f92672>=</span><span style=color:#960050;background-color:#1e0010>/usr/bin/code serve-web --port 8080 --host 0.0.0.0 --without-connection-token</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>Restart</span><span style=color:#f92672>=</span><span style=color:#a6e22e>always</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>Type</span><span style=color:#f92672>=</span><span style=color:#a6e22e>simple</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>User</span><span style=color:#f92672>=</span><span style=color:#a6e22e>ec2</span><span style=color:#f92672>-</span><span style=color:#a6e22e>user</span>
</span></span><span style=display:flex><span>              
</span></span><span style=display:flex><span>              [<span style=color:#a6e22e>Install</span>]
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>WantedBy</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>multi</span><span style=color:#f92672>-</span><span style=color:#a6e22e>user</span>.<span style=color:#a6e22e>target</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>EOF</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>sudo</span> <span style=color:#a6e22e>systemctl</span> <span style=color:#a6e22e>daemon</span><span style=color:#f92672>-</span><span style=color:#a6e22e>reload</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>sudo</span> <span style=color:#a6e22e>systemctl</span> <span style=color:#a6e22e>enable</span> <span style=color:#f92672>--</span><span style=color:#a6e22e>now</span> <span style=color:#a6e22e>code</span><span style=color:#f92672>-</span><span style=color:#a6e22e>server</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>              <span style=color:#960050;background-color:#1e0010>#</span> <span style=color:#a6e22e>Install</span> <span style=color:#a6e22e>Node</span>.<span style=color:#a6e22e>js</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>sudo</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>u</span> <span style=color:#a6e22e>ec2</span><span style=color:#f92672>-</span><span style=color:#a6e22e>user</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;&lt;</span><span style=color:#a6e22e>EOF</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>curl</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>o</span><span style=color:#f92672>-</span> <span style=color:#a6e22e>https</span><span style=color:#f92672>:</span><span style=color:#75715e>//raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh | bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>source</span> .<span style=color:#a6e22e>bashrc</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>nvm</span> <span style=color:#a6e22e>install</span> <span style=color:#ae81ff>20.11.0</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>nvm</span> <span style=color:#a6e22e>use</span> <span style=color:#ae81ff>20.11.0</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>EOF</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>-</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>validate</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>steps</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>-</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>VSCodeValidate</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>action</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ExecuteBash</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>inputs</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>commands</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>-</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span>              <span style=color:#960050;background-color:#1e0010>#</span><span style=color:#f92672>!</span><span style=color:#960050;background-color:#1e0010>/bin/bash</span>
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>if</span> <span style=color:#f92672>!</span> <span style=color:#a6e22e>command</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>v</span> <span style=color:#a6e22e>code</span> <span style=color:#f92672>&amp;&gt;</span> <span style=color:#960050;background-color:#1e0010>/dev/null</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>then</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>echo</span> <span style=color:#e6db74>&#34;code could not be found&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>exit</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>-</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>validate</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>steps</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>-</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>NodeJSValidate</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>action</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ExecuteBash</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>inputs</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>commands</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>-</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span>              <span style=color:#960050;background-color:#1e0010>#</span><span style=color:#f92672>!</span><span style=color:#960050;background-color:#1e0010>/bin/bash</span>
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>if</span> <span style=color:#f92672>!</span> <span style=color:#a6e22e>command</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>v</span> <span style=color:#a6e22e>node</span> <span style=color:#f92672>&amp;&gt;</span> <span style=color:#960050;background-color:#1e0010>/dev/null</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>then</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>echo</span> <span style=color:#e6db74>&#34;Node could not be found&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>exit</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>-</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>test</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>steps</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>-</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>TestWhetherAppDeploy</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>action</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ExecuteBash</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>inputs</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>commands</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>-</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span>              <span style=color:#960050;background-color:#1e0010>#</span><span style=color:#f92672>!</span><span style=color:#960050;background-color:#1e0010>/bin/bash</span>
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>if</span> <span style=color:#f92672>!</span> <span style=color:#a6e22e>sudo</span> <span style=color:#a6e22e>lsof</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>i</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>n</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>P</span> <span style=color:#f92672>|</span> <span style=color:#a6e22e>grep</span> <span style=color:#ae81ff>8080</span> <span style=color:#f92672>|</span> <span style=color:#a6e22e>grep</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>w</span> <span style=color:#a6e22e>code</span> <span style=color:#f92672>&amp;&gt;</span> <span style=color:#960050;background-color:#1e0010>/dev/null</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>then</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>echo</span> <span style=color:#e6db74>&#34;App could not be found&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>exit</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>fi</span>
</span></span></code></pre></div><p>This document consists of 3 parts:</p><ul><li><p>Build: Based on the user-data of the previous part. Install VS Code as a web app listening on port 8080.</p></li><li><p>Validation: Check if NodeJS and VS Code have been successfully installed</p></li><li><p>Test: Check if the web app exists and listens on port 8080</p></li></ul><h3 id=step-5-select-create-component>Step 5: Select “Create Component”.</h3><p><img alt=Untitled src=/images/part6/6.2.1-step5-1.png></p><p>Result:</p><p><img alt=Untitled src=/images/part6/6.2.1-step5-2.png></p><h3 id=step-6-sub-create-a-new-version-by-selecting-action--create-new-version>Step 6 (Sub): Create a new version by selecting Action → Create new version.</h3><p><img alt=Untitled src=/images/part6/6.2.1-step6.png></p><p>Just change the content of the content section and edit the value of the Component version section and select Create component</p><h3 id=622-create-a-role-for-ec2-image-builder>6.2.2. Create a role for EC2 Image Builder</h3><h3 id=step-1-select-aws-service-use-case-ec2>Step 1: Select <code>AWS service</code>, use case <code>EC2</code></h3><p><img alt=Untitled src=/images/part6/6.2.2-step1.png></p><h3 id=step-2-add-policies-as-shown-below>Step 2: Add policies as shown below</h3><p><img alt=Untitled src=/images/part6/6.2.2-step2.png></p><h3 id=step-3-name-the-role-ec2imagebuilderinfraconfigrole-and-describe>Step 3: Name the Role <code>EC2ImageBuilderInfraConfigRole</code> and describe</h3><p><img alt=Untitled src=/images/part6/6.2.2-step3.png></p><h3 id=623-create-pipeline>6.2.3. Create pipeline</h3><h3 id=step-1-go-to-pipeline-consolehttpsus-east-1consoleawsamazoncomimagebuilderhomeregionus-east-1createpipeline>Step 1: Go to <a href="https://us-east-1.console.aws.amazon.com/imagebuilder/home?region=us-east-1#/createPipeline">pipeline console</a>.</h3><h3 id=step-2-name-the-pipeline-vsc-pipeline--description-optional>Step 2: Name the pipeline <code>VSC-Pipeline</code> . Description optional.</h3><p><img alt=Untitled src=/images/part6/6.2.3-step2.png></p><p>You can also choose the option <code>Enable EC2 image scanning</code> to ensure ami security.</p><h3 id=step-3-in-the-build-schedule-section-select-manual-and-then-select-next>Step 3: In the Build schedule section, select <code>Manual</code> and then select Next.</h3><p><img alt=Untitled src=/images/part6/6.2.3-step3.png></p><h3 id=step-4-in-the-recipe-section-select-create-new-recipe--select-ami-in-image-type>Step 4: In the Recipe section, select <code>Create new recipe</code> . Select <code>AMI</code> in Image type</h3><p><img alt=Untitled src=/images/part6/6.2.3-step4.png></p><h3 id=step-5-general-name-the-ami-and-version>Step 5: General, name the ami and version</h3><h3 id=step-6-base-image-select-select-managed-images-and-amazon-linux>Step 6: Base image, select <code>Select managed images</code> and <code>Amazon Linux</code></h3><p><img alt=Untitled src=/images/part6/6.2.3-step6.png></p><h3 id=step-7-at-image-origin-select-quick-start--at-image-name-select-amazon-linux-2023-x86--select-compatible-version-currently-select-use-latest-available-os-version>Step 7: At Image origin, select <code>Quick start</code> . At Image name, select <code>Amazon Linux 2023 x86</code> . Select compatible version, currently select <code>Use latest available OS version</code></h3><p><img alt=Untitled src=/images/part6/6.2.3-step7.png></p><h3 id=step-8-in-working-directory-type-homeec2-user-because-it-will-download-nvm-into-the-home-directory-of-the-executing-user-which-is-ec2-user>Step 8: In Working directory, type <code>/home/ec2-user</code> because it will download nvm into the home directory of the executing user, which is ec2-user.</h3><p><img alt=Untitled src=/images/part6/6.2.3-step8.png></p><h3 id=step-9-in-filter-owner-in-components-section-select-owned-by-me-select-the-created-component>Step 9: In <code>Filter owner</code> in Components section, select <code>Owned by me</code>. Select the created component.</h3><p><img alt=Untitled src=/images/part6/6.2.3-step9-1.png></p><p>In the image is version 1.0.1, because the step to create a new version was added in the previous section (the component content remains unchanged).</p><p>In Test components - Amazon Linux section, for demo purposes, select <code>reboot-test-linux</code> .</p><p><img alt=Untitled src=/images/part6/6.2.3-step9-1.png></p><h3 id=step-10-leave-the-storage-section-as-default-and-then-next>Step 10: Leave the Storage section as default and then Next.</h3><p><img alt=Untitled src=/images/part6/6.2.3-step10.png></p><h3 id=step-11-in-the-define-image-creation-process-section-select-next>Step 11: In the Define image creation process section, select Next.</h3><h3 id=step-12-in-the-infrastructure-configuration-section-select-create-a-new-infrastructure-configuration-name-it-vsc-infraconfig-select-the-iam-role-you-created>Step 12: In the Infrastructure configuration section, select <code>Create a new infrastructure configuration</code>. Name it <code>VSC-InfraConfig</code>. Select the IAM role you created.</h3><p><img alt=Untitled src=/images/part6/6.2.3-step12.png></p><h3 id=step-13-expand-the-vpc-subnet-and-security-groups-section-select-instance-type-as-t3medium-vpc-as-vsc-created-in-part-4-select-1-of-2-private-subnets-select-security-group-with-vsc-security-without-inbound-rule-of-previous-part-to-be-able-to-create-and-evaluate-instance-select-next>Step 13: Expand the VPC, subnet and security groups section. Select instance type as <code>t3.medium</code>, VPC as <code>VSC</code> (created in Part 4), select 1 of 2 <code>private subnets</code>, select security group with <code>VSC</code> (security without inbound rule of previous part) to be able to create and evaluate instance. Select Next.</h3><p><img alt=Untitled src=/images/part6/6.2.3-step13-1.png></p><p>Recall about security group outbound rules:</p><p><img alt=Untitled src=/images/part6/6.2.3-step13-2.png></p><h3 id=step-14-leave-distribution-settings-as-default-and-then-next>Step 14: Leave distribution settings as default and then Next.</h3><p><img alt=Untitled src=/images/part6/6.2.3-step14.png></p><h3 id=step-15-after-reviewing-select-create-pipeline>Step 15: After reviewing, select Create pipeline.</h3><h2 id=63-create-instance-from-ami-built-from-pipeline>6.3. Create instance from AMI built from pipeline</h2><h3 id=631-create-ami-from-pipeline>6.3.1. Create AMI from pipeline</h3><h3 id=step-1-select-the-newly-created-pipeline-in-the-action-box-select-run-pipeline>Step 1: Select the newly created pipeline. In the Action box, select Run pipeline:</h3><p><img alt=Untitled src=/images/part6/6.3.1.-step1-1.png></p><p>A green notification appears.</p><p><img alt=Untitled src=/images/part6/6.3.1.-step1-2.png></p><h3 id=step-2-click-view-details-to-monitor-the-details>Step 2: Click <code>View details</code> to monitor the details:</h3><p><img alt=Untitled src=/images/part6/6.3.1.-step2.png></p><p>See Image status is Testing.</p><h3 id=step-3-select-the-log-stream-link-to-monitor-the-pipelines-cloudwatch-log-stream>Step 3: Select the log stream link to monitor the pipeline&rsquo;s CloudWatch log stream</h3><p>Test phase, step <code>TestWhetherAppDeploy</code>:</p><p><img alt=Untitled src=/images/part6/6.3.1.-step3-1.png></p><p>RebootTest phase:</p><p><img alt=Untitled src=/images/part6/6.3.1.-step3-2.png></p><p>If there is an error, exit code 1, if there is no error, exit code 0. Finally, the test instance has no error.</p><h3 id=step-4-go-back-to-the-running-pipeline-when-the-ami-build-is-finished-the-image-status-changes-to-available-click-on-the-created-image-version-the-image-below-is-1041>Step 4: Go back to the running pipeline. When the ami build is finished, the image status changes to Available. Click on the created image version (the image below is 1.0.4/1):</h3><p><img alt=Untitled src=/images/part6/6.3.1.-step4.png></p><h3 id=step-5-observe-the-image-created-from-ec2-image-builder-click-on-the-ami-link>Step 5: Observe the image created from EC2 Image Builder. Click on the AMI link:</h3><p><img alt=Untitled src=/images/part6/6.3.1.-step5.png></p><h3 id=step-6-observe-the-ami-from-the-ec2-page>Step 6: Observe the ami from the EC2 page</h3><p><img alt=Untitled src=/images/part6/6.3.1.-6.png></p><p>The AMI has been successfully created, and has passed the tests during the pipeline process without any errors.</p><h3 id=632-create-an-instance-from-the-newly-created-ami>6.3.2. Create an instance from the newly created AMI</h3><h3 id=step-1-go-to-the-ami-page-of-the-ec2-console-select-the-newly-created-ami-click-launch-instance-from-ami>Step 1: Go to the AMI page of the EC2 console. Select the newly created ami. Click <code>Launch instance from AMI</code></h3><p><img alt=Untitled src=/images/part6/6.3.2.-step1.png></p><h3 id=step-2-select-the-instance-type-to-save-choose-t2micro->Step 2: Select the instance type. To save, choose <code>t2.micro</code> .</h3><h3 id=step-3-no-key-pair-required>Step 3: No key pair required.</h3><p><img alt=Untitled src=/images/part6/6.3.2.-step3.png></p><h3 id=step-4-select-vpc-and-security-group-with-vsc--private-subnet-make-sure-there-is-no-public-ip>Step 4: Select VPC and security group with <code>VSC</code> , private subnet, make sure there is no public IP</h3><p><img alt=Untitled src=/images/part6/6.3.2.-step4.png></p><h3 id=step-5-provide-iam-instance-profile-with-vsc-to-install-ssm-agent>Step 5: Provide IAM instance profile with <code>VSC</code> to install SSM agent</h3><p><img alt=Untitled src=/images/part6/6.3.2.-step5.png></p><h3 id=step-6-select-create-instance>Step 6: Select <code>Create instance</code></h3><h3 id=step-7-wait-until-instance-status-available>Step 7: Wait until instance status <code>Available</code></h3><p><img alt=Untitled src=/images/part6/6.3.2.-step7.png></p><h3 id=step-8-access-vscode-web-app-using-session-manager-via-port-forwarding-jsx-aws-ssm-start-session----target-i-06ae65824244ff79b----document-name-aws-startportforwardingsessiontoremotehost----parameters-host100132106portnumber8080localportnumber8080--untitledimagespart663-2-step8png-access-successful>Step 8: Access VSCode web app using Session Manager via port forwarding <code>jsx aws ssm start-session ^ --target i-06ae65824244ff79b ^ --document-name AWS-StartPortForwardingSessionToRemoteHost ^ --parameters host="10.0.132.106",portNumber="8080",localPortNumber="8080" </code>![Untitled](/images/part6/6.3 .2.-step8.png) Access successful!</h3><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=/AWS-Remote-VSC-to-EC2/5-extended-create-an-ami-from-an-instance-and-run-an-instance-from-that-ami/ title=Appendix><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/AWS-Remote-VSC-to-EC2/7-connect-vscode-using-ec2_instances_connect-and-aws-systems-manager/ title="Connect VScode using EC2_Instances_Connect and AWS Systems Manager" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/AWS-Remote-VSC-to-EC2/js/clipboard.min.js?1724927887></script><script src=/AWS-Remote-VSC-to-EC2/js/perfect-scrollbar.min.js?1724927887></script><script src=/AWS-Remote-VSC-to-EC2/js/perfect-scrollbar.jquery.min.js?1724927887></script><script src=/AWS-Remote-VSC-to-EC2/js/jquery.sticky.js?1724927887></script><script src=/AWS-Remote-VSC-to-EC2/js/featherlight.min.js?1724927887></script><script src=/AWS-Remote-VSC-to-EC2/js/highlight.pack.js?1724927887></script><script>hljs.initHighlightingOnLoad()</script><script src=/AWS-Remote-VSC-to-EC2/js/modernizr.custom-3.6.0.js?1724927887></script><script src=/AWS-Remote-VSC-to-EC2/js/learn.js?1724927887></script><script src=/AWS-Remote-VSC-to-EC2/js/hugo-learn.js?1724927887></script><link href=/AWS-Remote-VSC-to-EC2/mermaid/mermaid.css?1724927887 rel=stylesheet><script src=/AWS-Remote-VSC-to-EC2/mermaid/mermaid.js?1724927887></script><script>mermaid.initialize({startOnLoad:!0})</script><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-158079754-2","auto"),ga("send","pageview");function updateImageSources(){var e=document.querySelectorAll("img");e.forEach(function(e){const t=e.src,n=new URL(t);e.src=baseurl.concat(n.pathname)})}updateImageSources()</script></body></html>